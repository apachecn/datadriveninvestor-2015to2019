# 区块链——一个落后的多线程系统

> 原文：<https://medium.datadriveninvestor.com/blockchain-just-a-laggy-multithreaded-system-d68fca0102b2?source=collection_archive---------10----------------------->

[![](img/3a20e4a34d9613f7d153dfbced04f7f3.png)](http://www.track.datadriveninvestor.com/1B9E)![](img/fb6b88f4b6e17a2272b49fa7bf9167c4.png)

Photo by [Jacob Miller](https://unsplash.com/@kineticbear?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

作为我们研究过程的一部分，一个有趣的类比出现在与团队成员之一欧文的谈话中。归根结底，像区块链这样的分布式系统可以像在本地机器上运行的多线程应用程序一样被概念化，并有许多相同的约束。

# 了解多线程

说多线程编程难，对了一半。更准确地说，编写*好的*多线程代码是困难的。困难来自于拥有一些共享状态(CPU 缓存)和让多个线程在它们之间共享资源。显然，如果两个独立的进程试图同时使用高速缓存的同一个部分，这将导致一个问题，为此，有[各种协议](https://en.wikipedia.org/wiki/Cache_coherence)来防止对共享内存的同时写入。

将这一点扩展到区块链，分布式分类帐本质上是一个共享的内存缓存，它必须在整个并发系统中保持一致，并仔细分配写权限，以防止同时写入同一内存位置。

# 作为互斥体的阻塞提议机制

区块链防止同时写入的方法是在整个系统中建立某种形式的数据块建议机制。这些有多种风格，通常是“*x 的证明*”的形式，其中共享状态中的不一致可以基于对发布者提供的“x”的证明的共识来解决。

证明条件充当共享状态上的[互斥](https://en.wikipedia.org/wiki/Mutual_exclusion)，解锁发布者的写权限，并更新状态。

# 延迟、工作证明和概率发布

多线程在本地系统中运行良好，因为 CPU 的内核通常尽可能靠近，从而将线程之间的延迟降至纳秒而不是毫秒级。然而，在像区块链这样的分布式系统中，网络延迟成为共享状态的“锁定时间”中的一个因素。在所有节点都意识到这一变化之前，它们也可以通过获得写许可来尝试发起它们自己的变化。对于某些使用非概率方法来提议区块的区块提议方法，这不是问题，因为共识规则通常只允许一次提议一个变更。然而，在工作证明的情况下，两个节点可能同时独立地获得对区块链的共享状态的写许可的概率是非零的。这导致了链的分叉，共识规则必须决定向前移动时要包括哪些更改，这实质上使共享缓存的一部分无效。

# 摘要

从概念的角度来看，区块链和多线程系统实际上非常相似，因为两者都是并发运行的，考虑到拜占庭容错的挑战，研究后者的最佳实践可以更好地理解前者。