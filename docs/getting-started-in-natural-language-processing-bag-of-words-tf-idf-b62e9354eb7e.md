# 自然语言处理入门:单词包& TF-IDF

> 原文：<https://medium.datadriveninvestor.com/getting-started-in-natural-language-processing-bag-of-words-tf-idf-b62e9354eb7e?source=collection_archive---------0----------------------->

拉斯·德洛斯·桑托斯

机器学习的一些应用，如图像和音频处理，从一开始就已经在分析矢量化数据。这些特定数据的值(幅度和方向)已经可以为算法提供有意义的信息，如音频信号的噪声水平或图像中像素的值和位置，从而使计算更容易。

![](img/bb05ab99111a09924088a34660672193.png)

[Figure 1\. White Noise Signal](https://upload.wikimedia.org/wikipedia/commons/c/c1/White_noise.svg)

然而，对于文本，尤其是人类语言，情况就不同了。机器学习模型不能直接处理原始文本！这个问题现在提出了另一个难题——我们如何将文本转换成有意义的数字或向量，以便它们对 ML 管道有用？简单地将原始文本转换成例如二进制、十进制或十六进制表示，肯定不会给我们单词的函数表示，因为这些值不能捕获关于单词(例如“国王”和“王后”或“猫”和“狗”)之间的含义、上下文和相关性的信息。应用将一组文档表示为公共向量空间中的向量的模型可以解决这个问题。

**向量空间模型**是连续向量空间中单词的多维表示。在模型中，彼此紧密或语义相关的单词往往彼此更接近。

![](img/909ad6de0db62a478b7328759c3e3dbf.png)

Figure 2\. VSM sample visualization. *Source: Polyvyanny & Kuropka, 2009*

有两种模型可用于将单词“转换”成向量:

1.  **基于计数的模型** —一种依赖于文档中单词频率的计算模型。
2.  **预测模型** —基于相邻词预测上下文或目标词的模型。

让我们首先使用基于计数的模型来处理矢量化，这种模型被称为词袋(BoW)和术语频率-逆文档频率(TF-IDF)。

## **词袋模型**

单词袋模型(BoW)是一种矢量化技术，它使用单词在文档或语料库中的出现次数，语料库本质上被定义为已知单词的数据集。以下面的一组文档为例。

*   “我是国王。”
*   “王国繁荣昌盛。”
*   “她是女王。”
*   “皇家皇后很漂亮。”

现在可以通过列出这组文档中所有独特的单词来制作语料库。通常，要阅读的第一个单词是语料库中列出的第一个单词。需要注意的是，BoW 并不关心单词的顺序。因此，我们的语料库现在将是:

![](img/02953fe4b59ff4edebfd8390ea9646c7.png)

最后，为了使用 BoW 将样本文本转换成向量，对样本文本中语料库单词的每次出现进行计数，并输出为大小与语料库相同的整数计数的数组。例如，示例文本“国王和王后统治王国”将具有以下向量表示:

[ 0, 0, 3, 1, 1, 0, 0, 0, 0, 0, 0 ]

如下面字数所示:

![](img/b4521a75c7838e09c90262322803576b.png)

## **词频-逆文档频率**

TF-IDF 是 BoW 的一个高级变体，它根据单词在文档中的稀有性来考虑单词的重要性。然而，与 BoW 等离散计数的矢量不同，转换后的矢量现在包含连续的值。这个想法可以通过下面的等式得到最好的解释:

![](img/72e63e6c03d14bfdb96f9b4f5a2220b9.png)

***tf weight*** 是归一化的字数统计。规范化基本上意味着获取单词的相对计数，以避免偏向较长的文档。它是从以下等式推导出来的:

![](img/4ae688291d41f55ec09ac1a36dbef9ec.png)

因此，假设我们有一个长度为 150 个单词的文档，目标术语为“狗”。如果“dog”在文档中出现 5 次，则“dog”的 tf 权重为:

![](img/b16cda19bf34da3ca6e0f0a11213bc66.png)

***idf 权重*** 通过给频繁出现的词赋予低权重来衡量该词在语料库中的重要性，对于很少出现的词反之亦然。它使用带有公式的对数函数:

![](img/925192f41bcf41068c79c2f20ebcfc4d.png)

回到这个例子，如果在一百万个文档的数据集中，有 10，000 个文档出现了“狗”这个词，那么 idf 权重就是:

![](img/003b280494ad651eb8f91df0f62cbe70.png)

最后，术语“狗”的重量是

![](img/4aea45e91e5b98493fc6fec756c45c04.png)

.

## **实施**

*使用的框架:。NET 4.7.2，Accord.NET v 3.8*

为了理解如何使用上述概念将单词转换成向量，我尝试使用 C#实现 BoW + tfiDF。具体来说，我使用了 Accord.NET 框架，因为它能够更容易地实现理论。

在深入编码之后，我安装了实现所需的必要包。我通过调用“using”指令导入了相关的名称空间。对于 Accord.NET，尤其是雅阁。MachineLearning 命名空间，我使用了 NuGet 包管理器。通常，最终包含的名称空间如下所示:

![](img/3f34d3c2c89100345eda6d6664bad40d.png)

我创建了一个简单的文档集，如下所示。

![](img/b8eb96fdc55cc5c379c040d3e7223eb2.png)

按道理，我应该有整个语料库的单词袋。因此，单词被“标记化”，并使用 Tokenize()方法将其保存到名为 document_words 的交错字符串数组中。我从语料库中找到了单个单词。

![](img/29a154b9a78e22c7ab476fd9abdade43.png)![](img/a949a06a602f0314dc75ff211f32ae09.png)

然后，我通过使用 new TFIDF()制作 tfidf 的实例，尝试学习上面的单词，如下所示。为了初始化前面讨论的数学，我选择了 TermFrequency。Default 和 inversedocumentfrequency . default

![](img/b06983fccb00bdd166e76c775b950454.png)

接下来，我调用了 Learn()方法，并将 document_words 作为其参数，将语料库转换为 tfidf 值。这也将删除重复的单词，因为我们只需要词汇表中每个单词的一个实例。

![](img/e8529473dc81dfb7032f8af06531a0e1.png)

我们最终得到了一个包含 11 个值的向量:

[ tfidf_1，tfidf_2，tfidf_3，…。，tfidf_11 ]

在这个过程之后，我用不同于我们刚刚学习的数据集的文本(如下所示)对它进行了测试。

![](img/856f6b81cb5ddaee9e62ca442f13d13b.png)

使用 Accord.NET，将新文本转换成基于先前学习的数据集的 tfidf 是相当容易的。首先，我对单词进行了类似于前面过程的标记，并将其用作调用 Transform()方法的参数。

![](img/fc101948889a54134feb3840b975844e.png)

打印 test_weights 的值会给我们测试句子的向量表示。

![](img/91a500cb0e333e0b5ccf625fae628261.png)

探索如何将单词转换成向量可以成为自然语言处理的一个很好的切入点，正如我在这个项目中所做的那样。选择像 BoW+tfidf 这样相当简单的数学转换可以让您深入了解文本中以及语料库本身中的单词是如何相互关联的。通过最终将数据输入机器学习管道进行分类或预测任务，您可以在这一步发挥更大的作用。

**参考文献:**

[](https://www.tensorflow.org/tutorials/representation/word2vec) [## 单词的向量表示|张量流核心|张量流

### 目标是对嵌入参数\(\theta\)进行更新，以改进(在这种情况下，最大化)这个目标…

www.tensorflow.org](https://www.tensorflow.org/tutorials/representation/word2vec)  [## Tf-idf::单页教程——信息检索和文本挖掘

### Tf-idf 代表术语频率-逆文档频率，常用于信息检索和文本…

www.tfidf.com](http://www.tfidf.com/) 

A.增强的基于主题的向量空间模型的定量评估。

立即获取您的 RAX 编辑器！这是一个免费的机器人过程自动化(RPA)软件:[免费下载这里](https://www.raxsuite.com)