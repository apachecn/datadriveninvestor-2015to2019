# 金融服务中的战略机器学习

> 原文：<https://medium.datadriveninvestor.com/strategic-machine-learning-in-financial-services-a39e80de63a3?source=collection_archive---------3----------------------->

机器学习模型是复杂的流程链，其中许多不同的步骤相互联系，以创建一个有凝聚力的生产流程。随着金融服务的数字化转型，采用主动部署机器学习的精通数字的复杂金融科技的作用至关重要。

*随着新的数字转型压力成为竞争范式，金融服务和金融科技领域的大多数公司(如果不是全部的话)正在积极推进机器学习的现有边界。*

*未能优先考虑战略、机器学习驱动的数字化转型的公司，可能无法重塑其传统商业模式。除非他们将复杂的机器学习方法与巨大的数据宝库结合起来，否则金融将是一个机器学习有和没有的世界。*

要了解机器学习在金融服务领域的变革力量的潜力和局限性，最简单的方法是关注机器学习项目的工作流程，以强调黑盒模型的古老格言:*垃圾进，垃圾出*。

但这里的方法是不同的:重点不是工作流步骤，而是过程之间的关系和过程本身中机器学习的使用。通过解释过程中的传统步骤，机器学习的关键方面浮出了水面:复杂的模型推动了可解释性和可解释性的新标准，同时要求严格的模型验证。

[](https://www.datadriveninvestor.com/2019/02/08/machine-learning-in-finance/) [## 金融中的机器学习|数据驱动的投资者

### 在我们讲述一些机器学习金融应用之前，我们先来了解一下什么是机器学习。机器…

www.datadriveninvestor.com](https://www.datadriveninvestor.com/2019/02/08/machine-learning-in-finance/) 

随着机器学习成为许多金融服务应用中不可或缺的一部分，它正在脱离信用评估和风险评估。很少有人对机器学习如何影响金融有更广阔的视角；从不同的角度提供背景的雄心。

![](img/c920a87aac5d08ca960392b22f553e37.png)

机器学习[工作流程](https://cloud.google.com/ml-engine/docs/ml-solutions-overview)是相互关联和相互依赖的步骤的标准化链。无论机器学习项目的目的是[提取交易信号](https://sigmoidal.io/company/)(困难)还是建立一个[智能聊天机器人](https://developer.oracle.com/webfolder/java/build-intelligent-bots-based-on-machine-learning/index.html#/page/0)(稍微容易一些)，其顺序步骤都是众所周知的。偏离[已建立的订单](https://www.techopedia.com/definition/34027/machine-learning-workflow)可能会[痛苦](https://blog.datarobot.com/why-most-ai-projects-fail)。

# 我们采取的步骤

典型的机器学习工作流链接以下步骤:

1.数据采集和数据摄取
2。特征选择和特征工程
3。模型开发、测试和验证，以及性能评估
4。模型验证
5。模型部署、操作和监控

> 就像机器学习一样，在金融领域，数据的质量和数量同样重要。而且，这本质上不是一种权衡。

# 数据采集和数据摄取

金融机构收集了大量可用于机器学习项目的数据。有一句古老的格言是，你可以访问的数据越多，你的模型性能就越好，这句话绝对正确。但是[金融数据不同于](https://blogs.oracle.com/datascience/7-ways-time-series-forecasting-differs-from-machine-learning)通常用于机器学习目的的其他类型的数据。

![](img/666976a3eb81b2a5dfd8eadedcc78f34.png)

Photo by [NASA](https://unsplash.com/@nasa?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

由于金融服务公司正在从事变革性的机器学习项目，从客户保留和参与度测量到开发复杂的工具来提取市场中的交易信号，该流程结合了各种来源和类型的数据:

*   **结构化数据** —是高度组织化的柱状数据，可从数据库、电子表格或类似来源提取，其中数据具有特定的定义和已知含义，如客户余额信息、交易信息、资产价格、利率和交易量。
*   **半结构化** —比结构化数据更少结构化和组织化，后者可以使用标签和元数据在数据库中存储和查询，其中数据的具体含义不明显，需要使用层次结构或元数据来提取含义，如电子邮件元数据或自动归档标签。
*   **非结构化** —非结构化数据的含义只能通过分析技术提取，如电子邮件文本、新闻报道和公司文件。

虽然结构化数据最广泛地用于金融目的，但非结构化数据正在获得相当大的吸引力。过去，非结构化数据很难查询、管理和分析，现在机器学习方法正在发生变化。一些金融交易方法混合结构化和适当转换的非结构化数据来提取信号。T2 替代数据源 T3 在制定交易策略中的作用就是这种方法的一个例子。

> 当用例被清楚地制定时，替代数据只为机器学习模型提供有价值的输入。

![](img/23fbc3a60b3820c3250d85a715dfd2c4.png)

Photo by [Joshua Sortino](https://unsplash.com/@sortino?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

# 数据工程

带来和组合各种数据源需要处理不同类型和不同格式的数据，考虑到各种不同且有时相互冲突的数据格式、定义、数量和更新频率。

有两种不同的消化功能方法:

*   **批量**加工，和
*   实时，**流式传输**数据。

虽然传统上批处理信息是标准，但流式传输和捕获财务和其他交易数据是常见的。来自各种数据库、文件、日志文件、事件流、web 服务的信息都必须被捕获和存储。随着数据从实时交易监控转移到存储，然后转移到库存，数据的处理必须适应多种不同的数据类型和数据源，而不损失数据的保真度。

摄取是确保数据质量可靠的关键点。无论最终目标是智能聊天机器人还是复杂的执行算法，数据质量都是至关重要的。

# 机器学习

机器学习在这个过程中发挥了作用。非结构化或半结构化数据更难管理和分析。为了使这些数据有意义并适合分析，机器学习可以提取特征。例如，随着公司依靠机器学习将文本中的情感提取为可解释的信息，以前不太边缘化的数据源已经可以通过潜在有利可图的应用程序进行分析。

**情感分析**
一种越来越常用的非结构化数据源是从推文、新闻报道、社交媒体帖子、电子邮件和其他通信以及公司文件中提取的文本信息。使用自然语言处理工具，文本现在可以提供以前无法获得的洞察力。从聊天机器人到新闻的潜在影响，情感分析有着广泛的应用。

![](img/dffb83fa355e8522f2bca23b794d59ba.png)

Photo by [History in HD](https://unsplash.com/@historyhd?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

当代的一个例子是美国总统唐纳德·j·特朗普的[推文对](https://twitter.com/realdonaldtrump)[股市](https://www.forbes.com/sites/simonmoore/2019/01/10/how-trumps-tweets-impact-stocks/#2b128c616af3)表现的影响([https://www . Forbes . com/sites/Simon Moore/2019/01/10/how-trumps-tweets-impact-stokes/# 2b 128 c 616 af 3](https://www.forbes.com/sites/simonmoore/2019/01/10/how-trumps-tweets-impact-stocks/#2b128c616af3))。

**数据清理和预处理**
数据清理和预处理包括数据清理(去除“数字污垢”)、规范化(和标准化)、转换(重新缩放)，在特征选择发生之前。

**异常值检测**
检测异常值在金融领域非常重要。由于异常值不一定是错误，它们可以传达非异常值观察的实质性信号，有时[黑天鹅](https://en.wikipedia.org/wiki/Black_swan_theory)不能。查看等级排序和参数统计的传统度量可能会丢弃带有信息内容的观察结果。然而，识别离群值的复杂机器学习方法，如[各种提升树和聚类算法的组合](https://www.bis.org/ifc/publ/ifcb49_48.pdf)引入了另一层计算复杂性。

多层神经网络和遗传算法可以通过从数据中提取洞察力来帮助我们改善模型的输入。这增加了持续数据验证和模型可解释性的重要性。

> 这不是一个鸡和蛋的问题，而是一个相互依赖的问题，其中机器学习特征提取的结果间接影响了分析的结果，因此相互依赖本身导致了算法偏差。

![](img/c057686a2aeb85d786bafb2d9d59b799.png)

Photo by [Designer Viet Nam](https://unsplash.com/@designervn?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

而且，因为一些机器学习黑盒模型固有地遭受可解释性问题，甚至在建模发生之前控制、理解和管理建模结果的增量贡献者**是一个不小的问题。**

P *重新处理可能会影响基于模型的结果解释。*

![](img/37910c7917161728a97cabf26f9bbc14.png)

Photo by [Christopher Burns](https://unsplash.com/@christopher__burns?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

# 特征选择和特征工程

机器学习和金融数据集都可能非常庞大，即使没有数千个变量，也有数百个。为了使数据易于处理和建模更简单，可以使用各种特征选择和特征提取方法。

如何从基础数据集中选择特征可以提高机器学习模型的准确性。在选择特征时，重点应该放在与建模问题相关的变量上。仔细的特征选择是由数据的可用性、模型开发所考虑的方法以及机器学习模型试图解决的最终问题所驱动的。

> *特征选择是在变量中仔细而审慎的挑选，当它选择那些具有最大潜力的变量时，增加了模型的可解释性和可解释性。*

# 特征选择

无论是从经验角度还是从建模角度来看，特征选择无非是挑选具有解释力的变量。这不是相关性，而是可能的因果关系，以及有目的地消除潜在的虚假或不相关的变量。特征选择的结果直接影响最终模型的有效性、可靠性和可解释性。此外，在不牺牲准确性的情况下，改进算法中的数据也会影响建模和计算负载。

特征选择不是降维，而是消除那些不会为分析增加价值的变量，并且不涉及创建新特征或转换现有特征。特征工程负责后者，或者一旦模型被训练，维度减少可以在链上进一步移动，以集成到数据获取和摄取中。

# 特征工程

金融数据集可能非常庞大，各种降维技术可以提取主要变量。各种降维技术可以提取数据集中的主要成分，从而产生新的变量。

但是，主成分分析并不是降维的唯一工具。候选特征可以通过其他方法来识别，例如最大信息系数(MIC)和递归特征消除(RFE)。

通过创建或增强特征，机器学习模型的准确性可以提高。虽然传统的金融市场数据表现出时间序列数据的属性，但通常用于标准化和规范化神经网络输入的特征工程可能没有用。考虑到相关性，在很大程度上，跨时间序列的不良执行的特征工程将从模型中消除有价值的信息。

与此同时，特征工程在将现有的时间序列数据转换到不同的维度方面可能是有用的:通过从由时间段和时间范围定义的分笔成交点数据移动，数据可以在数量、价值和[数量和价值分笔成交点](https://github.com/Jackal08/financial-data-structures)方面进行重铸，以提取对市场轨迹和深度的不同见解。

对于对话聊天机器人，工作流程通常需要通过[自然语言处理](https://dzone.com/articles/simple-sentiment-analysis-with-nlp)提取基于情感的数据特征，并进行后续训练和验证。这种预处理取决于目标本身:除了情感识别之外，可能还有实体识别和意图识别。意图识别分析语料库中词的语法功能和结构。在模型被训练之前，所有这些步骤都必须被合并到特征工程中。

![](img/8f88fc7ddff951dba0a4800d192b8361.png)

Photo by [Baim Hanif](https://unsplash.com/@baim?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

## 阶级失衡问题

组合了来自不同数据源的信息并以不同速度和频率摄取的数据集可能会出现类不平衡问题，其中模型的某个特征可能没有被充分表示。如何解决不平衡问题(各种过采样和欠采样方法、分层采样或合成数据)会影响最终数据。正在做出的选择将对整个流程产生影响，因此这些考虑因素也需要在模型开发过程中加以考虑。

# 模型开发、培训、测试

模型开发由多个相互关联的迭代步骤组成。它是选择最合适的算法来拟合目标，并根据数据训练模型。

模型构建展示了一个广泛的领域:从对稀疏、低维数据的简单线性回归，到人工智能驱动的聊天机器人的开发，这些聊天机器人可以进行复杂的基于意图的对话，根据使用结构化和非结构化数据对大型数据集进行的训练提供建议，并通过使用神经网络进行建模。

不同的方法用于不同的目的。许多金融服务公司偏爱复杂的神经网络、情感分析和基于树的模型，作为他们建模选择的基准。

任何机器学习管道的核心是确保应用程序在实践中按照预期工作，这需要模型满足性能基准。但是，机器学习模型可能很难解释，测试和验证过程可能是一个复杂的过程。

# 模型验证

验证必须在部署前和部署后进行。使用一个或多个适当的度量标准的组合来监控验证。性能通常在整个开发周期中作为基准，任何偏差都要单独评估。

这种方法虽然复杂且令人费解，但却使开发人员能够在周期的不同阶段评估模型的性能。耦合来自数据质量评估管道的多个因素，并根据模型性能变量，进一步提供模型如何执行的洞察力。对工作流和增量结果的综合评估形成了模型的最终评估和最终可靠性。

> 模型验证方法不断发展，以应对与机器学习的独特性质、规模和复杂性相关的挑战。

**复杂性**
由于机器学习应用擅长分析复杂和大量的多维数据，因此金融领域的潜在应用越来越多，其中的复杂性不仅仅是模型的复杂性。

![](img/65976ddddef66358d255cc4bb502fa23.png)

Photo by [John Barkiple](https://unsplash.com/@barkiple?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

虽然金融和金融服务中的许多统计和数学模型通常或多或少是复杂的线性回归，但机器学习应用程序(如神经网络或其他非线性方法)提供了更复杂的方法来从数据中识别和提取有意义的信号。因为相关性不是线性的，并且互相关性不以线性方式传播，所以机器学习方法可能变得更适合于从相同的数据中捕捉额外的信息。

> 随着这种额外的复杂性，对模型可解释性的关注出现了。

实际上，随着复杂性和计算开销的增加，在模型开发和验证方面可能会有额外的好处。然而，在模型验证框架中，特别是在受监管的金融服务公司中，模型验证的责任也可能演变成一个复杂的问题。

![](img/2a9cd649dcef83c687d62c1dbf1f94c0.png)

Photo by [Kelly Sikkema](https://unsplash.com/@kellysikkema?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

**数据泄露**

考虑到金融时间序列的独特相关性特征，验证过程还会受到不恰当分割的金融数据集的数据泄漏风险的影响。控制数据泄漏，更具体地说，适当地控制模型验证中维持数据的影响，是机器学习开发必须考虑的另一个复杂性，特别是因为验证本身会导致算法偏差。

# 模型部署、操作和监控

机器学习部署通常包括单独的数据处理和分析步骤。公司可以在内部开发这些应用程序，也可以通过出售的模型在外部开发，或者两者结合使用。无论如何，模型开发的复杂性进一步加剧了模型部署和操作化的复杂性

![](img/0ce9fd21b766d0faacc35a4e0e226693.png)

Photo by [Milada Vigerova](https://unsplash.com/@mili_vigerova?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

# 棘手问题

随着金融服务公司从机器学习中提取可操作的价值，有一些额外的警告不太技术性，但更具战略性和可操作性，会影响成功。如今，一切都使用人工智能，即使该工具是一个执行不力的 OLS 回归。 ***炒作真实*** 。

鉴于创新的巨大压力，对定义不清的机器学习项目的需求往往是超现实的，并且是自我牺牲的。

*   由于设计不良的需求，人才库的构成很难快速通过。虽然真正缺乏好的机器学习工程师，但更缺乏的是理解业务需求和建模现实的机器学习领导者。即使是自动 ML 解决方案也需要[工程技能和沟通技能](https://www.mckinsey.com/business-functions/organization/our-insights/will-artificial-intelligence-make-you-a-better-leader)。
*   开发、培训、测试、部署和监控的成本很大程度上取决于解决底层业务问题所需的定制级别。由于不切实际和不合理的期望，类似项目的成本计算通常很难解决。
*   研究和发展，R&D，机器学习的费用是昂贵的。训练复杂的定制模型不仅需要工时，还需要复杂的工具、难以定义的计算资源和昂贵的计算基础设施。云部署并不总是一个选项。