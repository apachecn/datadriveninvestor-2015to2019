# 利用 VLR 数据进行短期交通预测——模型开发和验证

> 原文：<https://medium.datadriveninvestor.com/short-term-traffic-prediction-using-vlr-data-model-development-and-validation-a1d8ef03c5eb?source=collection_archive---------7----------------------->

我们主要使用 5 种方法来开发短期交通预测模型。它们是神经网络、贝叶斯组合神经网络、隐马尔可夫模型、回归和贝叶斯可加回归树。接下来的部分提供了关于这些方法和我们用来验证模型的技术的更多细节。

# 模型开发方法

## 神经网络

我们使用具有 5 个隐藏层的多层前馈神经网络作为交通预测的基本模型。在对用于此目的的层数进行了小规模研究后，我们决定使用五个隐藏层。我们有 4 条道路从早上 6:00 到下午 4:00 的数据，我们用属于不同道路的数据检查我们的模型。我们将总时间段划分为 10 分钟的时间段，最后，有 60 个小时间段，每个时间段 10 分钟。对于这些时间段中的每一个，我们找到了给定道路的该时间段的标准化用户计数。我们还保留了一个额外的字段来标识时间段是高峰还是非高峰。

我们从与神经网络相关的 3 个不同的途径获得了成功。在每种情况下，模型的输入是不同的，并且模型的输出是给定路段的接下来 10 分钟的交通水平，该交通水平是低、中或高之一。在第一种方法中，我们输入归一化的用户计数和附加的 0 或 1，分别指示时间段是非高峰还是高峰。

在第二种方法中，我们输入预测交通的道路的归一化用户数，以及将来从附近道路到交通预测道路的归一化用户数。由于我们有一个交叉点的 VLR 数据，我们可以在跟踪用户所走的路径后，使用可用的 VLR 数据来计算从一条道路转向另一条道路的概率。使用计算出的转向概率，我们计算将从附近 4 条道路到达交通预测道路的用户数量，并将所有 5 个标准化用户计数输入神经网络。我们用两种方法计算了全天从一条道路转向另一条道路的概率(从早上 6:00 转向下午 4:00 的一般概率)和特定时段的概率(从早上 6:00 转向上午 9:00、上午 9:00 转向下午 1:00 和下午 1:00 转向下午 4:00 的特殊概率)。

在第三种方法中，我们使用了两个神经网络。对于第一个神经网络，我们输入道路的时间段和标准化用户计数的峰值/非峰值位，并获得给定路段的接下来 10 分钟的用户计数作为神经网络的输出。然后，对于第二个神经网络，我们输入该时间段的峰值/非峰值位，以及我们从第一个神经网络获得的输出，即接下来 10 分钟的用户计数。第二个神经网络为给定路段产生接下来 10 分钟的交通水平。

## 贝叶斯组合神经网络

在这种情况下，我们使用贝叶斯方法组合了两个神经网络模型。这两种类型的神经网络是反向传播神经网络和径向基函数神经网络。预先不可能知道哪个神经网络在特定时间间隔中的给定时间段内表现最佳，因此贝叶斯组合神经网络是合适的，因为预测可以在线或实时发生，从而最终从组合模型中获得最佳可能的预测。

考虑到 Borella 交汇处环岛的两个路段作为完整路径的一部分进行分析，我们采用了连续的时间间隔，并将其划分为组合网络的训练集和测试集。基于先前路段的先前和当前时间间隔，从反向传播和径向基神经网络计算当前路段的当前时间间隔的用户计数。对于测试数据集，计算贝叶斯组合神经网络预测值，然后使用归一化用户计数和时间间隔的峰值或非峰值质量从反向传播神经网络进行验证。

作为上述方法的延伸，该研究还关注了多条道路对一个路段的影响，以及一周内交通重复行为的影响。

## 隐马尔可夫模型

马尔可夫模型是用于分析包括随时间变化的状态序列的数据的统计模型。当状态不可见但可以使用观察到的状态来估计时，使用隐马尔可夫模型。在我们的研究中，在马尔可夫模型中，一天中每 10 分钟时间间隔内的交通状态可以映射为隐藏状态，一天中时间间隔内的移动用户计数可以映射为观察状态。一段时间内的流量级别分为“低”、“中”和“高”。通过将用户计数的范围划分为四分位数，观察到的用户计数被映射为 4 种状态“0”、“1”、“2”和“3”。

通过计算最优转移矩阵和发射矩阵，构建了隐马尔可夫模型。我们使用 HMM 作为预测模型，首先计算最可能的观察序列，然后估计相关的状态序列。为了得到最优的转移矩阵，我们首先使用了 Baum-Welch 算法。然而，我们忽略了这一点，因为它对结果没有显著影响。

最初，隐马尔可夫模型获得的大多数预测都不太准确。然而，在选定的道路上，它们并没有发生剧烈的变化。这里我们使用一阶隐马尔可夫模型来预测下一个状态。在一阶隐马尔可夫模型中，有限地平线假设被认为是正确的。为了分析先前状态的影响，我们不断提高隐马尔可夫模型的阶数。n 阶隐马尔可夫模型假设如下。

***P(xm|x1，x2，…..，xn，…，XM 1)= P(XM | x1，x2，…..*，xn)**

随着 n 的增加，预测的准确性增加。最后，我们可以通过这种方法达到 70%以上的准确率。

## 回归

鉴于短期交通预测的性质，预测模型中计算的简易性与其准确性同样重要。回归模型已被证明满足这两个要求。已经有很多尝试使用回归进行交通预测。参数和非参数回归模型都用作预测模型。参数回归模型假设基础流量数据呈正态分布。使用用户计数和峰值非峰值状态进行预测的线性回归给出了非常差的结果。很明显，流量数据与用户计数和高峰或非高峰状态没有线性关系。

非参数模型不假设数据的基本分布。k-最近邻回归、logistic 回归和支持向量机回归提高了准确率。但是核回归给出了最好的准确度。内核回归通过使用特定内核带宽(数据点的选定窗口)的内核基函数，尝试将本地数据点拟合到分布中。内核带宽可以是固定带宽、基于自适应最近邻的带宽或基于广义最近邻的带宽。核的阶数越高，模型的灵活性就越大。但是更多的灵活性带来了过度拟合的机会。因此，选择给出最佳结果的最简单的核决定了核回归的准确性和适用性。基于所使用的权重估计函数，可以指定各种核。核类型包括二阶、四阶、六阶和八阶高斯和 Epanechnikov 核，以及均匀核。当 Epanechnikov 核的带宽类型固定且核阶数为 4 时，核回归方法比其他回归模型具有更好的准确性。

## 贝叶斯可加回归树

贝叶斯加性回归树(BART)是一种树或回归树总和的集成方法。这是非参数函数估计的贝叶斯方法。回归树依赖于将预测器空间递归二进制分割成一组超矩形，以便逼近未知函数。BART 由结构和叶参数的一组先验以及终端节点中数据的似然性组成。

BART 模型可表示如下，其中 Y 是 n×1 响应向量，X 是 n×p 设计矩阵，E 是 n×1 噪声向量。这里有 M 个不同的回归树，每个回归树由树结构和叶组成，树结构用 T 表示，叶用 M 表示。这两个树一起用 T 表示，M 表示整个树及其结构和叶参数集。

***Y = f(X) + ε ≈ T M 1 + T M 2 + …。*t M M+ε，ε∾Nn(0，σ2 In)**

通过对树的每个非末端节点使用分裂规则，每个观察通过树结构进行。最后将所有的树叶参数值相加得到预测值。采用多种方法来确定最适合我们预测空间的函数。

# 模型验证

我们使用 11 日和 12 日的数据训练模型，同时使用 14 日的数据进行测试。每个数据集包含 60 个 10 分钟间隔的记录。因此，我们测量了每个模型预测的准确性，即模型正确预测流量水平的记录数的百分比。因此，通过使用下面的等式计算每个模型的准确度百分比。

***准确率=(正确预测记录数× 100) /总记录数***

神经网络方法可以获得最高的准确率(85%)。(使用 2 个神经网络组合的方法)