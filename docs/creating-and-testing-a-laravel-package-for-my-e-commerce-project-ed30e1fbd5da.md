# 为我的电子商务项目创建和测试一个 Laravel 包

> 原文：<https://medium.datadriveninvestor.com/creating-and-testing-a-laravel-package-for-my-e-commerce-project-ed30e1fbd5da?source=collection_archive---------18----------------------->

[![](img/837bb6c7a4e2b60c6137d27cb4bff260.png)](http://www.track.datadriveninvestor.com/1B9E)

**免责声明:**说到拉勒维尔和作曲家的世界，我是相当“绿色”的。所以如果你在这里看到我的文章有明显的瑕疵，请温柔一点。

**我用的是:**

*   Ubuntu 16.04
*   7.2.13
*   作曲家 1.8
*   管弦乐队/测试平台 3.8 @开发

对我来说，Laravel 的一个主要吸引人的地方是易于在一个项目中分离出组件，这些组件可以有自己的控制器、视图、模型、路径等等。我最近开始了一个新项目，它的核心是一个电子商务应用程序。我正在实施的功能之一是为我们的工作人员创建博客和文章，将在主要的电子商务网站托管的迷你 CMS。我认为这个特性是尝试创建 Laravel 包的一个很好的方式。这是我如何做的，也是我从自己的经历中学到的。

# **它是一个独立的组件还是我只是在移动代码？**

我的电子商务项目的早期设计理念可能有点过于强调“打包所有东西”的方法。我想为如何处理支付、运输报价、定价等创建单独的包(带有单独的 Git repos)。我认为我在欺骗自己，以为我会为这些服务中的每一项创建包，我就自动遵循了 SoC 设计原则。

但事实不一定如此，如果我的定价方案对产品做出了巨大的改变，那么我的支付方案将受到影响，以及其他依赖于产品价格的领域。

经过反复思考，对软件包和 monolith 应用程序设计做了更多的研究，我决定不“打包所有的东西”。当项目的核心严重依赖它时，将处理产品定价的代码放入单独的包和存储库中对我来说没有意义，反之亦然。

然而，包装 CMS 仍然是一个不错的选择。创建的页面将在他们自己的单独的网址和那些已经被主项目使用的可以列入黑名单。运行 CMS 不需要主项目中的任何东西(除了 Laravel 项目之外), CMS 中的任何改变都会影响主项目(除了如何处理路由之外，但这可以很容易地根据项目进行配置)。

# **创建包**

我按照 Wisdm 实验室写的这个非常有用的教程来创建这个包。这很简单，主要是服务提供商和 psr-4 名称空间设置正确。

# 测试这个东西

因为我创建的包有自己的控制器、迁移和我想要测试的模型，所以我需要安装 Laravel。在我对 Laravel 包开发的研究中，我遇到了几种不同的策略来正确地设置测试环境。

第一个是创建一个新的 Laravel 项目，并在其中创建您的包。我是这样开始的，我遵循 Wisdm 实验室的教程，学习如何在 Laravel 项目中创建和集成一个包。我在包的主项目文件夹中创建并运行我的测试…..

![](img/ecd9f165154b2815cda67a95fbcf431c.png)

Yup, that’s not right

好吧，这很糟糕。但是我仍然需要访问 Laravel 来从我的包代码中测试我的包。所以我在主 Laravel 项目中对包进行了符号链接，这解决了我在包的控制器测试中无法访问 App\Controllers(或任何主 Laravel 控制器名称空间)的问题。这仍然感觉非常奇怪，然后我找到了管弦乐队/测试台。

我最喜欢 Orchestra\Testbench 的一点是，这是一个包含在项目中的开发依赖性。对我来说，这感觉像是一个更平滑的开发环境，并且可以很容易地设置。只需 git 克隆包的 repo，安装 composer，就可以开始测试了。

关于项目设计和 Laravel 的来龙去脉，我学到的比我想象的要多得多。有时候，当我只想运行我的测试而不必为所有的设置而烦恼时，这是非常令人沮丧的。但是我想当你在处理一个如此大的框架时，这是一种折衷。感谢您阅读本文，如果您对建筑和 Laravel 有任何建议或见解，请随时分享！