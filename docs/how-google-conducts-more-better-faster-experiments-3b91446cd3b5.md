# 谷歌如何进行更多/更好/更快的实验

> 原文：<https://medium.datadriveninvestor.com/how-google-conducts-more-better-faster-experiments-3b91446cd3b5?source=collection_archive---------8----------------------->

谷歌最初在 2010 年发表了一篇关于建立实验基础设施的论文，以支持更快、更好和更多的实验。下面是 [*环节*](https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/36500.pdf) *。以下是理解谷歌方法的粗略尝试。*

![](img/22b104939df07ab3ef043ff00afbe545.png)

概述:谷歌进行实验，修改用户界面，改变影响排名或内容选择的 ML 算法。为了支持这一目标，谷歌需要:

1.  足够的基础设施来支持
2.  支持基础设施使用的各种工具
3.  帮助用户更好地利用这些资产的伟大教育过程

**定义实验:**

1.  人口中有代表性的部分
2.  感兴趣进行测试的变更(例如，UI 等可见变更或分级输出中底层 ML 算法的变更等不可见变更)
3.  对人口代表性部分(测试组和对照组)的分割
4.  对感兴趣的变化的反应。这就是目标。(例如，点击率、转换率、销售额或其他类型的业务指标等。)

在谷歌，实验的目的是:

1.  测试新产品功能
2.  探索现有功能周围的空间

# **当前的挑战(截至 2010 年在谷歌？)**

跟上创新的速度是困难的。测试尽可能多的想法是必要的，但不支持。

**与实验基础设施相关的挑战**:

1.  单层实验结构:每个查询最多在一个实验中。这易于使用且灵活，但可扩展性不足。
2.  多因素实验结构:每个参数(因素)都可以独立进行实验。一个参数的每个实验值与所有其他参数的每个其他实验值重叠。每个实验查询将同时出现在 N 个实验中，N 是参数(因子)的数量。即使这种结构也是不切实际的，因为在谷歌，有成千上万的参数需要实验，而且不是每个阶乘组合都需要测试(例如，粉红色背景上的粉红色文本)。

**更好的实验基础设施的目标:**

1.  更多:同时运行更多实验的可扩展性和运行不同配置/大小的灵活性，同时保持统计显著性
2.  更好:无效实验根本就不应该运行。有效但不好的实验应该被迅速捕捉并禁用。应该提供标准化的度量标准
3.  更快:快速而容易地建立一个实验

**建议的解决方案:**

1.  将参数划分为子集。每个子集都包含不能相互独立变化的参数。
2.  每个子集都与包含实验的层相关联。每个实验查询将在 N 个实验中，N 是层数。
3.  每个实验只能修改与其层相关联的参数，同一参数不能与多个层相关联。

# 实验文学的背景:

有三个实验领域:

1.  传统统计文献中的单因素和多因素实验。
2.  运行网络实验。Kohavi 已经比较全面的做了一篇这方面的论文。
3.  交叉实验。这是一种专门评估排名变化的实验。

# 支持这个提议的实验系统的结构和关键概念

1.  **域**:这是一个流量分段
2.  **层**:这是系统参数的子集
3.  **实验**:这是一个流量分段，零个或多个系统参数可以被赋予不同的值，这些值会改变传入请求的处理方式
4.  **启动层**:与实验层不同，它们包含在默认域中。它们是参数的单独划分。它们用于在不干扰现有实验的情况下逐步向所有用户推出变更，并以标准化的方式跟踪这些推出。
5.  **分流类型**:域名如何分流。这可以随机完成，也可以通过使用 Cookie Mods 来产生流量转移。
6.  新代码:这些方法用于在少量流量上测试新代码，确保新代码没有错误。交通拥挤时，这种编码会起作用。
7.  **二进制文件**:具有功能的代码/脚本的集合。在这个上下文中，它是某种类型的可执行文件。

给定基础设施，评估和启动典型特征的过程如下:

1.  在正确的二进制中实现新功能(代码审查、二进制推送、默认值等。)
2.  创建一个小流量的金丝雀实验，以确保该功能正常工作。如果不工作，那么更多的代码需要编写/修改。
3.  创建一个或一组实验来评估特征。实验部分包括导流类型、参数、条件和受影响系统参数的说明
4.  评估来自实验的指标。根据结果，可能会出现额外的迭代。通过修改或创建新的实验来进行额外的迭代。
5.  如果有问题的功能是可启动的，则启动过程开始:
6.  然后创建启动层和启动实验。这是为了逐步增加发射层实验，然后最终删除发射层并更改相关参数的默认值

# 支持重叠基础架构的工具和流程

## 工具:数据文件检查实用程序

对输入文件进行自动数据检查，以防止无用/损坏的实验发生。检查包括以下内容:

**一致性和约束错误**

1.  id 的唯一性
2.  实验是否在正确的层
3.  层是否有足够的流量来支持
4.  这个实验要求的流量是其他实验要求的吗
5.  基本实验设计检查(实验是否有控制…)
6.  域名的转移方式和其他域名一样吗？

## **工装:实时监控&实验分析**

这些工具可以尽可能快地捕获和跟踪基本指标，以便确定是否有任何意外情况发生。工具实用程序包括:

1.  选择要跟踪的指标
2.  为单个指标和这些指标上的护栏设置预期范围
3.  护栏通信:如何以及在哪里进行通信
4.  实验关闭
5.  配置和调整实验参数

虽然以上用于实现同步实验并加快实验过程，但实验分析工具是硬币的另一面。

实验分析工具用于为实验人员检查以评估实验的一组指标提供准确的值。多个指标可以组合成一个单一的目标函数，但实验者也可以检查一套指标。

实验分析工具的关键设计目标包括:

1.  正确计算和显示置信区间
2.  易于使用和理解的良好用户界面
3.  支持切片:聚合数字应该向下钻取
4.  可扩展性:应该添加自定义指标

## 实验设计、规模确定、前期后期

实验的有效规模:

n =(1/控制查询+1/实验 query)^-1

在这个迭代中，标准误差的估计可能是一个挑战。

**Pre period** 是开始实验之前的一段时间，在这段时间内，相同的流量被转移到实验中，但没有进行任何改变。这是为了确保分流的交通流量确实与控制人口流量相似。

**后期**相同，但在实验结束后。这有助于确定是否存在从实验中获得的效果。

## **实验基础设施采用教育**

上面讨论的工具和基础设施是实现更多、更好、更快实验所需的技术考虑。在人的方面，实验应该是:

1.  精心设计的
2.  实验结果被理解和传播

**实验委员会:**

这是一个工程师委员会，审查实验者在进行实验之前填写的轻量级清单。这些问题涉及:

1.  基本实验特征(实验测试什么，假设是什么)
2.  实验设置(哪些实验参数是可变的，每个实验或每组实验测试什么…)
3.  实验分流和触发(分流使用何种分流类型和条件，分流流量的多大比例触发实验)
4.  实验分析(哪些度量是感兴趣的，实验者想要检测多大的变化)
5.  实验规模和持续时间(给定受影响的流量，实验有足够的统计能力来检测所需的度量变化)
6.  实验设计(前期和后期是否有保证)

这样做的好处是，它是一种传播与实验相关的最新最佳实践的有用方式。Checklist 是一个托管的 web 应用程序。

**解读数据**

另一个过程是一个论坛，实验者带着结果与专家讨论。该论坛的目标是:

1.  确保实验结果有效
2.  给定有效的结果，确保所查看的指标是一个完整的集合，有助于理解正在发生的事情。
3.  给出一组完整的结果，讨论并就该实验总体上是正面还是负面的用户体验达成一致，以便决策者可以使用这些数据来确定是否要进行变革。